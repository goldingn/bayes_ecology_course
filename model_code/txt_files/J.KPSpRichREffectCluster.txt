model
{
  mlogarea <- mean(logarea[])   # means of explanatory variables
  mvwall <- mean(vwall[])
  memerg <- mean(emerg[])
  msubmerg <- mean(submerg[])
  mfring <- mean(fring[])
	
  a ~ dnorm(0, 1.0E-6)  # prior for intercept term
	
  for (j in 1:5)
  {
    b[j] ~ dnorm(0, 1.0E-6)     # prior for regression coefficients
  }

  sd_cluster ~ dunif(0, 100)    # prior for sd of variation among clusters
  prec_cluster <- 1/sd_cluster/sd_cluster   # sd converted to precision

  # for each of the 26 clusters
  for (i in 1:26)
  {
    recluster[i] ~ dnorm(0, prec_cluster)   # generate random cluster effects
  }

 # for each of the 104 ponds
  for(i in 1:104)
  {
    nlogarea[i] <- logarea[i] - mlogarea   # calculate the centred explanatory variables
    nvwall[i] <- vwall[i] - mvwall
    nemerg[i] <- emerg[i] - memerg
    nsubmerg[i] <- submerg[i] - msubmerg
    nfring[i] <- fring[i] - mfring
	
	# calculated expected species richness, including random effect of cluster
    m[i] <- exp(a + b[1]*nlogarea[i] + b[2]*nvwall[i] + b[3]*nemerg[i] + b[4]*nsubmerg[i] + b[5]*nfring[i] + recluster[cluster[i]])  
    SR[i] ~ dpois(m[i])
  }

  for (i in 1:20)   # predictions versus submergent vegetation
  {
    pred_sub[i] <- exp(a + b[4]*(5*(i-1) - msubmerg))
  }

  for (i in 1:25)
  {
    pred_area[i] <- exp(a + b[1]*(0.2*i - mvwall))   # predictions versus area
  }
}


Inits
list(a = 0, b = c(0, 0, 0, 0, 0), sd_cluster=1)


Data
cluster[]	logarea[]	vwall[]	emerg[]	submerg[]	fring[]	SR[]
1	3.870111155	0	0	0	50	1
2	3.326949994	1	5	2	100	1
2	2.85672889	1	20	0	100	1
2	1.62324929	1	60	0	85	1
2	4.629684769	1	1	0	30	1
2	0.698970004	1	20	70	0	0
2	2.155336037	1	1	0	25	1
2	1.886490725	1	1	8	0	1
2	3.100715087	1	8	2	30	1
2	2.494154594	1	50	0	50	1
2	3.177247836	1	20	20	30	1
2	3.314499228	1	10	5	30	1
3	2.257678575	0	30	30	80	2
3	1.531478917	0	95	15	90	1
3	1.397940009	1	95	10	30	1
3	1.041392685	1	25	0	60	1
3	2.089905111	1	60	30	10	1
3	1.361727836	1	90	0	2	1
3	0.301029996	1	50	20	90	0
3	0.698970004	1	50	20	90	0
4	3.750816843	1	5	0	5	0
4	2.399673721	0	50	0	80	0
5	1.986771734	1	5	1	0	0
5	3.324693914	1	15	0	30	1
6	3.044931546	1	5	0	15	1
6	3.377488383	1	5	0	0	1
6	1.591064607	1	0	0	0	1
6	2.330413773	1	0	0	0	0
6	1.447158031	1	1	0	30	0
7	3.103461622	0	10	5	60	7
7	2.699837726	0	60	5	100	6
7	3.832955751	0	50	20	100	6
7	2.687528961	0	35	50	95	4
7	2.769377326	0	10	70	100	3
7	2.707570176	0	60	25	100	7
7	2.482873584	0	15	70	80	6
7	3.671635597	0	15	5	100	5
7	4.017283822	0	10	5	100	5
7	3.409595019	0	25	5	100	8
7	3.1752218	0	70	10	60	5
7	3.679246145	0	5	1	100	6
7	2.598790507	0	30	25	80	6
7	2.298853076	0	35	50	100	7
7	4.100852827	0	20	30	100	6
7	3.137354111	0	60	20	100	2
7	2.928395852	0	97	2	100	1
7	3.122543524	0	80	5	100	6
7	2.338456494	0	15	5	60	3
7	3.557386882	0	40	15	100	3
7	3.293583513	0	5	1	10	4
7	2.440909082	0	40	20	80	5
7	3.515211304	0	5	1	50	2
7	3.592287816	0	100	0	100	4
7	1.716003344	0	5	30	70	0
8	2.181843588	1	40	20	40	1
8	2.95568775	1	15	0	35	1
8	1.462397998	1	0	0	0	0
8	2.225309282	1	25	5	5	1
8	2.103803721	0	20	0	100	1
8	2.344392274	1	25	0	90	1
8	1.462397998	1	1	0	100	1
8	1.414973348	1	0	0	0	0
8	1.698970004	0	0	0	0	0
8	3.087426457	1	60	0	55	1
9	2.911157609	0	85	0	15	2
10	4.412913926	0	40	5	100	4
10	4.087745935	0	35	5	100	3
10	2.515873844	1	15	0	60	1
11	2.797959644	1	5	0	70	1
12	4.708454894	0	6	4	99	4
12	3.508260306	0	90	0	90	1
13	3.678062905	0	5	1	90	1
14	3.363423933	0	1	1	50	4
14	4.398061594	0	90	10	50	5
15	4.909764569	0	5	60	100	3
15	4.286209386	0	40	30	100	2
15	4.529212126	0	50	15	100	2
15	2.240549248	0	10	0	40	2
15	3.812512284	0	20	60	100	2
16	3.047274867	1	0	40	0	0
17	4.174205227	0	0	0	0	0
18	4.097465554	0	10	5	80	3
19	2.788875116	0	20	10	25	1
19	2.82672252	0	20	5	25	1
20	3.750662646	1	2	0	20	1
20	3.003891166	0	25	10	25	5
21	3.913442955	0	15	5	55	1
22	1.204119983	1	0	0	0	0
23	0.477121255	1	0	0	70	0
23	1.477121255	0	1	0	20	0
23	1.041392685	1	25	0	10	0
23	0.903089987	1	5	0	0	0
23	1.113943352	0	15	0	65	1
23	0.77815125	1	30	60	0	0
23	0.84509804	1	20	0	10	0
23	0.77815125	0	0	20	50	0
23	2.155336037	1	0	0	0	0
23	1.255272505	1	0	0	75	0
23	1.176091259	1	10	0	40	0
23	1.462397998	0	15	50	20	0
24	4.690869158	0	3	20	98	1
24	3.599227863	0	2	90	98	1
25	2.318063335	0	20	5	100	2
26	3.671543085	0	1	0	15	1
END


